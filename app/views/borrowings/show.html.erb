<% content_for :title, "Borrowing Details" %>

<div class="page-header">
  <h1>Borrowing Details</h1>
  <div class="actions">
    <% if @borrowing.active? %>
      <%= link_to "Return Book", return_book_borrowing_path(@borrowing), 
                  method: :patch, class: "btn btn-success",
                  confirm: "Mark this book as returned?" %>
    <% end %>
    <%= link_to "Back to Borrowings", borrowings_path, class: "btn" %>
  </div>
</div>

<div class="borrowing-details">
  <div class="detail-card">
    <h3>Borrowing Information</h3>
    <p><strong>Student:</strong> <%= link_to @borrowing.student.name, @borrowing.student %></p>
    <p><strong>Student ID:</strong> <%= @borrowing.student.student_id %></p>
    <p><strong>Book:</strong> <%= link_to @borrowing.book.title, @borrowing.book %></p>
    <p><strong>Author:</strong> <%= @borrowing.book.author %></p>
    <p><strong>Category:</strong> <%= @borrowing.book.category.name %></p>
    <p><strong>Borrowed Date:</strong> <%= @borrowing.borrowed_at.strftime("%B %d, %Y at %I:%M %p") %></p>
    
    <% if @borrowing.returned_at %>
      <p><strong>Returned Date:</strong> <%= @borrowing.returned_at.strftime("%B %d, %Y at %I:%M %p") %></p>
      <p><strong>Duration:</strong> <%= (@borrowing.returned_at.to_date - @borrowing.borrowed_at.to_date).to_i %> days</p>
      <p><strong>Status:</strong> <span class="status returned">Returned</span></p>
    <% else %>
      <p><strong>Days Borrowed:</strong> <%= (Date.current - @borrowing.borrowed_at.to_date).to_i %> days</p>
      <p><strong>Status:</strong> <span class="status active">Active</span></p>
    <% end %>
  </div>
</div>